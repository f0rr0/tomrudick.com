var Music = function() {
    var data = {{json music_monthly}};

    return {
        init: function(element) {
            var data = {{json music_monthly}};

            var series_data = [];
            for (var i = 0; i < data.length; i++) {
                series_data.push({
                    x: data[i][0],
                    y: data[i][1]
                })
            }

            series_data.push({
                x: {{ music.today.timestamp}},
                y: {{ music.today.total }}
            })

            var palette = new Rickshaw.Color.Palette( { scheme: 'classic9' } );
            var graph = new Rickshaw.Graph( {
                element: document.getElementById(element),
                width: 780,
                height: 150,
                renderer: 'bar',
                stroke: true,
                preserve: true,
                series: [
                    {
                        color: '#81ad00',
                        data: series_data,
                        name: 'Listens'
                    }
                ]
            });

            graph.render();

            var hoverDetail = new Rickshaw.Graph.HoverDetail( {
                graph: graph
            });

            var ticksTreatment = 'glow';
            var yAxis = new Rickshaw.Graph.Axis.Y( {
                graph: graph,
                tickFormat: Rickshaw.Fixtures.Number.formatKMBT,
                ticksTreatment: ticksTreatment
            });

            yAxis.render();
        }
    }
}();